
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>naxoc.net</title>
  <meta name="author" content="Camilla Krag Jensen">

  
  <meta name="description" content="Here is a short simple tip to read json output from curl in a neat formatted way: Pipe the output to Python like this: 1
curl "http://url.to.call? &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://naxoc.net/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="naxoc.net" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-15300952-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:naxoc.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">
        <span class="site-title">
            naxoc.net
        </span>
       
           <span class="site-subtitle">
             Liking the holes in cheese since 1975
           </span>
       
    </a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About me</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/11/22/format-json-output-from-curl-neatly/">Format Json Output From cUrl Neatly</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-22T14:27:00+01:00" pubdate data-updated="true">Nov 22<span>nd</span>, 2013</time>
        
         | <a href="/2013/11/22/format-json-output-from-curl-neatly/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here is a short simple tip to read json output from curl in a neat formatted way:</p>

<p>Pipe the output to Python like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl "http://url.to.call?args=hi" | python -mjson.tool</span></code></pre></td></tr></table></div></figure>


<p>This will prettify the output and make json much more readable when testing webservices. It also validates the json, so if it contains errors you will get a warning.</p>

<p>It works with Python 2.6 and higher and you can find more info at the <a href="http://docs.python.org/2/library/json.html">Python docs page</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/11/10/color-schemes-and-productivity/">Color Schemes and Productivity</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-10T13:45:00+01:00" pubdate data-updated="true">Nov 10<span>th</span>, 2013</time>
        
         | <a href="/2013/11/10/color-schemes-and-productivity/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Almost all programmers have a color scheme or theme in their terminal and their code editor. Some people actually turns syntax highlighting off, but I will never understand that. To me &ndash; code is something that lives on a black or dark background and has syntax colors. I have only ever used a white background color scheme back when I was using Eclipse 8 years ago. And probably because I couldn&rsquo;t figure out how to set another color scheme than the one that comes with Eclipse.</p>

<p>Lately I have been really bothered by reflections in my glossy screen om my MBP and my Apple Cinema Display (I know &ndash; first world problem). In the afternoon all I could really see was me &ndash; like I was looking in a mirror. While that is very enjoyable it is not the way to get work done, so I set out to find a color scheme that would make it easier to see what I am working on and not myself so much. In that process I found out that I am super sensitive to changes in my editor work setup. Change the colors a little and I have a hard time reading through code fast. It is weird and a little bit stupid that it is so, but I can&rsquo;t help it. It takes me about 2 weeks to get reasonably comfortable with changes to a color scheme.</p>

<p>This blog post is really just a listing and some screen shots of the color schemes I like. And let me tell you right now: there is no dark background color scheme that solves the glare problem &ndash; I tried tons of them and none of them are magic. Moving your chair or source of light solves some of the glare problems, but if Apple would just go back to offering a non-glare version it would be a lot easier.</p>

<h2>The ones I like</h2>

<h3>Desert theme</h3>

<p>I really like the &ldquo;Desert&rdquo; color scheme that comes with Vim as one of the default color schemes.
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/color-scheme/vim-desert.png" title="'Vim desert color scheme'" >
The only thing I find a little annoying is the hysterically yellow line numbers. I have put this line in my .gvimrc to tone down line numbers after the color scheme is applied:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">hi</span> LineNr guifg<span class="p">=</span>grey50 guibg<span class="p">=</span>grey20
</span></code></pre></td></tr></table></div></figure>


<p>That is better:
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/color-scheme/desert-grey-numbers.png" title="'Vim desert theme with grey line numbers'" >
I haven&rsquo;t found a desert color scheme for PHPStorm yet. I also don&rsquo;t really like to use it in the terminal, so I guess the desert theme is a Vim thing for me.</p>

<h3>Tomorrow</h3>

<p>In both the terminal and PHPStorm I use the <a href="https://github.com/chriskempson/tomorrow-theme">Tomorrow theme</a>. It comes with support for a ton of different applications and is really well thought out. I started using this one because it has a white background version too. So much like the popular <a href="http://ethanschoonover.com/solarized">Solarized</a> theme it can use the same colors on light and dark background.
In the terminal I mainly use Tomorrow Night Eighties and in PHPStorm I switch between Tomorrow Night Eighties and just plain Tomorrow.</p>

<p>Here is the dark version (Tomorrow Night Eighties).
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/color-scheme/tomorrow-night-eighties-phpstorm.png" title="'Tomorrow Night Eighties in PHPStorm'" >
And here is the light version (Tomorrow).
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/color-scheme/tomorrow-phpstorm.png" title="'Tomorrow theme in PHPStorm'" ></p>

<p>I still mostly use the dark version, but when glare becomes too much I can pretty comfortably switch to the light version and still get stuff done. It is crazy how sensitive I am to having the colors be recognizable.</p>

<h2>Darcula</h2>

<p>This is the color scheme that comes with the look and feel for PHPStorm called Darcula. I think it is really good looking and I can use it &ndash; but only if there is not too much light. It is a little on the low contrast side.
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/color-scheme/darcula.png" title="'Darcula theme'" ></p>

<h2>The one I don&rsquo;t like so much</h2>

<h3>Solarized</h3>

<p>I realize that all code snippets on my blog use solarized. It is mainly because I haven&rsquo;t taken the time to change it. It really is not as simple as you would think in Octopress. Ironically &ndash; on the documentation site for Octopress solarized is not used. I haven&rsquo;t figured out what theme it using. Maybe it is solarized without the yellow background and just plain white.</p>

<p>Anyway. No reason the hate on solarized. So many people use it and love it. I just happen to think that the dark version has almost zero contrast and the yellow version makes me want to pee.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/10/28/finding-unused-images-in-your-website-code/">Finding Unused Images in Your Website Code</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-28T21:45:00+01:00" pubdate data-updated="true">Oct 28<span>th</span>, 2013</time>
        
         | <a href="/2013/10/28/finding-unused-images-in-your-website-code/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was doing a lot of changes to CSS files today &ndash; mainly deleting a whole lot of stuff. I wanted to see if there were image files that were referenced by CSS that were no longer in use, so I wrote this naïve little script that loops through all image files it finds in the dir you give it to see if there are references to the image files.</p>

<p>If you have <a href="https://github.com/ggreer/the_silver_searcher">The Silver Searcher</a> (ag) installed the script is much faster. Without Silver Searcher the script uses grep. If you don&rsquo;t know Silver Searcher go check it out &ndash; it is super fast.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="nv">DIR</span><span class="o">=</span>.
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;$1&quot;</span> <span class="o">]</span>
</span><span class='line'><span class="k">then</span>
</span><span class='line'><span class="k">  </span><span class="nv">DIR</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Find image files in.</span>
</span><span class='line'><span class="nv">FILES</span><span class="o">=</span><span class="sb">`</span>find <span class="nv">$DIR</span> -type f | grep <span class="s2">&quot;.*\.\(jpg\|gif\|png\|jpeg\)&quot;</span><span class="sb">`</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Default searcher is grep. If Silver Searcher is installed, use that.</span>
</span><span class='line'><span class="nv">SEARCHER</span><span class="o">=</span><span class="s1">&#39;grep -r -l &#39;</span>
</span><span class='line'><span class="k">if </span><span class="nb">command</span> -v ag
</span><span class='line'><span class="k">then</span>
</span><span class='line'>  <span class="c"># Sweet! Let&#39;s use Silver Searcher.</span>
</span><span class='line'>  <span class="nv">SEARCHER</span><span class="o">=</span><span class="s1">&#39;ag -l &#39;</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Loop over image files.</span>
</span><span class='line'><span class="k">for </span>f in <span class="nv">$FILES</span>
</span><span class='line'><span class="k">do</span>
</span><span class='line'><span class="k">  if</span> <span class="o">[[</span> -f <span class="nv">$f</span> <span class="o">]]</span>
</span><span class='line'>  <span class="k">then</span>
</span><span class='line'><span class="k">    </span><span class="nv">name</span><span class="o">=</span><span class="k">$(</span>basename <span class="nv">$f</span><span class="k">)</span>
</span><span class='line'>    <span class="nv">found</span><span class="o">=</span><span class="k">$(</span><span class="nv">$SEARCHER</span> <span class="nv">$name</span> <span class="nv">$DIR</span><span class="k">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">[[</span> -z <span class="nv">$found</span> <span class="o">]]</span>
</span><span class='line'>    <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nb">echo</span> <span class="nv">$f</span>
</span><span class='line'>    <span class="k">fi</span>
</span><span class='line'><span class="k">  fi</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://gist.github.com/naxoc/7203765">Gist is here</a> &ndash; I find that the gist plugin for Octopress is  broken.</p>

<h2>How to use the script</h2>

<ol>
<li>Don&rsquo;t use windows.</li>
<li>Download the gist and put it somewhere in your project.</li>
<li>cd to the script in your command line and go <code>chmod u+x unused-images.sh</code></li>
<li>Run the script by going <code>sh unused-images.sh</code> or <code>/.unused-images.sh</code>. If you pass a directory as an argument you will search in that dir only. If you don&rsquo;t pass an argument the script will search in the dir it is in, so be a little bit careful with doing that in a directory that contains thousands of files.</li>
</ol>


<p>The script outputs the images that have no references. So if you feel courageous you can delete the unused image files by piping the output to xargs and delete:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>./unused-images.sh themes | xargs rm
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/10/22/windows-in-virtualbox-on-the-mac/">Windows in VirtualBox on the Mac</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-22T21:06:00+02:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2013</time>
        
         | <a href="/2013/10/22/windows-in-virtualbox-on-the-mac/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have been doing more CSS and front-end stuff lately. I am having a lot of fun learning more about these things that I have somehow avoided doing for the last many years.</p>

<p>Today I realized that I don&rsquo;t have to own a MS Windows license to run a setup in a VM for browser-testing. While I don&rsquo;t hate Microsoft (anymore) I would really rather not buy a license for a product that I think is horrible. Anyway &ndash; I had no idea that it is super simple to set up a VM running whatever version of IE you want on Windows.</p>

<p>Installing the disk image was easy and I was up and running in very short time. I did however struggle a little with getting Windows to recognize the localhost (my Mac) and the vhosts I have on my local machine. I do all my development on my localhost, so I really needed Windows to understand my vhosts. Here is a writeup of what I did:</p>

<p>Note that I installed Win7 &ndash; the instructions for editing the hosts file might be different on other versions of Windows.</p>

<h2>Install VirtualBox</h2>

<p>First you need to install VirtualBox if you don&rsquo;t have it. Go grab an installer from the <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox Downloads page</a> and install it.</p>

<h2>Install the Windows image</h2>

<p>Now go to <a href="http://www.modern.ie/en-us/virtualization-tools">modern.ie&rsquo;s download page</a> and download a virtual machine in the IE version you would like to test stuff on. For this writeup I got an IE9 on Win7. Note that instead of downloading a lot of rar-files, you can just grab a cUrl command at the bottom of the downloadboxes and paste that into your terminal.</p>

<p>This part takes a good while, so be patient.</p>

<h2>Configure networking in VirtualBox</h2>

<p>Before you start Windows, you need to configure networking in VirtualBox. So go to VirtualBox and choose &lsquo;Preferences&rsquo; from the menu (or go Command-,). In the settings window &ndash; click &ldquo;Network&rdquo; and choose the &ldquo;Host-only Networks&rdquo; tab. On that tab there is a plus that you just click and accept. I didn&rsquo;t have to configure anything &ndash; I just got a configuration called <em>vboxnet0</em>. Go ahead and close preferences &ndash; this is a onetime setup thing. All images you install will be able to use these settings (if you want).
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/vm/vbox-networks.png" title="'Host-only Networks'" ></p>

<h2>Boot up Windows</h2>

<p> Now you can double click the image in VirtualBox&rsquo;s main window to start up Windows. Yup &ndash; you get the Windows sound.</p>

<h2>Find the Gateway</h2>

<p>Once Windows has booted up we need to configure the image to talk to our localhost. Click the start button or whatever it&rsquo;s called and type &lsquo;cmd&rsquo; in the textfield to get a &ldquo;terminal&rdquo;. Type <code>ipconfig</code> at the prompt and find the part in the output where it says &ldquo;Default Gateway&rdquo; under the &ldquo;Ethernet adapter Local Area Connection&rdquo;. Note that IP. It should be something like 10.0.x.x. Mine is 10.0.2.2.</p>

<h2>Set file permissions on the hosts file</h2>

<p>Now we need to edit Windows&#8217; hosts-file so that the vhosts we have on our Mac can be used. But first we have to change the file rights on the file. To open the Finder thingy, type <code>explorer C:\Windows\System32\drivers\etc</code> in at the prompt. That gives you the folder with the hosts-file. Now right click on that and select &ldquo;Properties&rdquo;. In the window you get, click the &ldquo;Security&rdquo; tab and then click the &ldquo;Edit button&rdquo;.
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/vm/win7-edit-file-rights-1.png" title="'File permissions'" >
 Select the &ldquo;Users&rdquo; group/user and tick the &ldquo;Full control&rdquo; box.
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/vm/win7-edit-file-rights-2.png">
All this probably is a horrible idea securitywise, but I don&rsquo;t really care &ndash; I&rsquo;ll use this Windows install very little. Click save and you&rsquo;re good.</p>

<h2>Edit the hosts file</h2>

<p>Now we can edit the hosts file. Double click on the hosts file and choose Notepad in the &ldquo;Open with dialog&rdquo;. Now you can add the urls that you have set up as vhosts on your Mac. Use the 10.0.x.x IP address from the <code>ipconfig</code> command like this for example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>10.0.2.2 d7.dev 
</span><span class='line'>10.0.2.2 d8.dev </span></code></pre></td></tr></table></div></figure>


<p>Save the file and you&rsquo;re done! I made a desktop shortcut to the file because I feel like I&rsquo;ll be back for more vhost-editing soon.</p>

<h2>Use IE!</h2>

<p>Now you can see your Mac&rsquo;s webserver&rsquo;s pages from your VM. So open up IE(!) and go to whatever url you put in the hosts file. I just want to point out one last thing: There is a Firebug Lite to be found in (this) IE if you click the gear in the upper right corner.
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/vm/firebug-lite.png"></p>

<p>Hope you found this very verbose walktrough helpful.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/10/06/setting-up-a-file-watcher-for-compass-in-phpstorm/">Setting Up a File Watcher for Compass in PHPStorm</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-06T20:55:00+02:00" pubdate data-updated="true">Oct 6<span>th</span>, 2013</time>
        
         | <a href="/2013/10/06/setting-up-a-file-watcher-for-compass-in-phpstorm/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>EDIT: <em>It seems that the version 7 early access now has a file watcher preset for Compass &ndash; nice work JetBrains! The part about scope from this blog post is still useful to you if you are on PHPStorm 7 though.</em></p>

<p>I started using PHPStorm about 6 months ago and while it is an extremely awesome and powerful IDE there are just so many things you can set up and configure. I have to admit that for the first couple of months I pretty much used PHPStorm just like I did Vim and not using any of the many configurable things except for the debugger. I am slowly venturing into playing around with setting more stuff up, and I thought I would share this one because it took me a while to get right.</p>

<p>It is super simple to use the <a href="http://compass-style.org/">Compass compiler</a> from the command line and I always have. But PHPStorm can compile your .scss files into .css on the fly so why not take advantage of that.</p>

<p>So here is what I did. The settings assume that you use something that resembles the default settings in a Compass project with a folder for the scss files and the css being output to another folder called something like &ldquo;stylesheets&rdquo; or &ldquo;css&rdquo; (could be anything really). You also need to have <a href="http://compass-style.org/install/">Compass installed on your machine</a>.</p>

<ol>
<li>In the PHPStorm settings, go to &ldquo;File Watchers&rdquo;.</li>
<li>Click the plus to add a watcher and choose SCSS.</li>
<li>Edit the settings to look like the ones on the screenshot. Where Compass is installed on your machine may not be in /usr/bin/compass like it is on mine, but you can use the command <code>whereis compass</code> from your command line to figure out where compass is. The output path is &ldquo;stylesheets&rdquo; for me for this particular project, but you shold edit that to whatever your project has named the css output folder.</li>
</ol>


<p><img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/compass-phpstorm.png" title="'Settings in PHPStorm'" ></p>

<p>Note that I have created a &ldquo;scope&rdquo; called Theme. Scopes in PHPStorm are parts of your project that you would like included or excluded in things like searches and settings like this Compass setup. There is no reason for PHPStorm to listen for changes to your module files if your theme folder is where you have your Compass project. So if you click the button with the three dots at the scope field you can setup PHPStorm to only look where it is relevant. I use scopes a lot to cut down on how long searches take, so setting up a few scopes for each project is time well spent.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/11/26/a-git-commit-hook-helps-you-keep-your-code-clean/">A Git Commit Hook Helps You Keep Your Code Clean</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-26T22:18:00+01:00" pubdate data-updated="true">Nov 26<span>th</span>, 2012</time>
        
         | <a href="/2012/11/26/a-git-commit-hook-helps-you-keep-your-code-clean/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I like to keep my code free of trailing whitespace. I feel what xjm describes as &ldquo;<a href="http://xjm.drupalgardens.com/review-guide">spinach in your teeth</a>&rdquo; about whitespace and non-conforming coding standards.</p>

<p>I got (heavily) inspired by Josh The Geek&rsquo;s <a href="http://drupal.org/sandbox/JoshTheGeek/1143338">git pre-commit hook</a>, and made myself a commit hook that will check the code I am about to commit for common errors. In addition to whitespace, I like to make sure that I don&rsquo;t accidentally commit debug code like <code>krumo()</code>. The commit hook also checks for common calls to debug functions.</p>

<p>If you want to use it, simply put it in your .git/hooks folder in your git checkout. Make sure the file is executable with <code>chmod +x .git/hooks/pre-commit</code>. This will only effect the git checkout you put the commit hook in, but you can make it apply to all future checkouts by putting it in your git install directory&rsquo;s template folder. Where that folder is will vary, but on my mac it is in /usr/share/git-core/templates/hooks.</p>

<p>The script is not the most clever in the world, so it will be wrong about some things from time to time. You can override it and still commit with the command <code>git commit -n</code></p>

<p>Here is the pre-commit file: <a href="https://gist.github.com/naxoc/4150599">Gist is here</a> &ndash; I find that the gist plugin for Octopress is horribly broken.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="c1">#!/usr/bin/php</span>
</span><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * @file</span>
</span><span class='line'><span class="sd"> * This is a Git pre-commit hook that informs you when you are</span>
</span><span class='line'><span class="sd"> * about to commit whitespace or a debug function.</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$red</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1;31m&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$red_end</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$yellow</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1;33m&quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$yellow_end</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="sd">/**</span>
</span><span class='line'><span class="sd"> * An array of functions to check for.</span>
</span><span class='line'><span class="sd"> */</span>
</span><span class='line'><span class="nv">$check</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dsm(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dpm(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dpr(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dprint_r(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; db_queryd(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; krumo&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; kpr(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; kprint_r(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; var_dump(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dd(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; drupal_debug(&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$check</span><span class="p">[]</span> <span class="o">=</span> <span class="s1">&#39; dpq(&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$return</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="nv">$diff</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span><span class='line'><span class="nb">exec</span><span class="p">(</span><span class="s1">&#39;git diff --staged&#39;</span><span class="p">,</span> <span class="nv">$diff</span><span class="p">,</span> <span class="nv">$return</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$return</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="s2">&quot;git diff returned an error. Commit aborted.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">foreach</span> <span class="p">(</span><span class="nv">$diff</span> <span class="k">as</span> <span class="nv">$lineno</span> <span class="o">=&gt;</span> <span class="nv">$line</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">substr</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Skip the line if you aren&#39;t adding something that may contain a debug</span>
</span><span class='line'>    <span class="c1">// function call.</span>
</span><span class='line'>    <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$check</span> <span class="k">as</span> <span class="nv">$lineno</span> <span class="o">=&gt;</span> <span class="nv">$function</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">strstr</span><span class="p">(</span><span class="nv">$line</span><span class="p">,</span> <span class="nv">$function</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{</span><span class="nv">$red</span><span class="si">}</span><span class="s2">Oh, noes! You were about to commit a </span><span class="si">$function</span><span class="s2">)?</span><span class="si">{</span><span class="nv">$red_end</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="nv">$yellow</span> <span class="o">.</span> <span class="nv">$line</span> <span class="o">.</span> <span class="nv">$yellow_end</span><span class="p">);</span>
</span><span class='line'>      <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Commit aborted.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="k">exit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$whitespace</span> <span class="o">=</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s1">&#39;git diff --staged --check&#39;</span><span class="p">);</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$whitespace</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>  <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{</span><span class="nv">$red</span><span class="si">}</span><span class="s2">Commit aborted. Fix trailing whitespace.</span><span class="si">{</span><span class="nv">$red_end</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="nb">fwrite</span><span class="p">(</span><span class="nx">STDOUT</span><span class="p">,</span> <span class="nv">$yellow</span> <span class="o">.</span> <span class="nv">$whitespace</span> <span class="o">.</span> <span class="nv">$yellow_end</span><span class="p">);</span>
</span><span class='line'>  <span class="k">exit</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// If this is still running, all is peachy. Let the developer commit.</span>
</span><span class='line'><span class="k">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/06/05/using-specific-versions-of-formula-with-homebrew/">Using Specific Versions of Formula With Homebrew</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-05T13:54:00+02:00" pubdate data-updated="true">Jun 5<span>th</span>, 2012</time>
        
         | <a href="/2012/06/05/using-specific-versions-of-formula-with-homebrew/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have my LAMP stack and other things set up on my mac with the wonderful <a href="http://mxcl.github.com/homebrew">Homebrew</a>.</p>

<p>I recently did a <code>brew upgrade</code> on my system and it seemed that everything went smooth. But when I later ran PHP from the command line I got this error:
<code>
PHP Warning:  PHP Startup: Unable to load dynamic library &lsquo;/usr/local/Cellar/memcached-php/2.0.1/memcached.so&rsquo; &ndash; dlopen(/usr/local/Cellar/memcached-php/2.0.1/memcached.so, 9): Library not loaded: /usr/local/lib/libmemcached.9.dylib
  Referenced from: /usr/local/Cellar/memcached-php/2.0.1/memcached.so
  Reason: image not found in Unknown on line 0
</code></p>

<p>I poked around in my php.ini to see if the wrong file was being included or something like that, but it turned out that I had upgraded to a newer version of libmemcached than the one memcached was using. So I needed to downgrade libmemcached. Here is how to switch to any version available with Homebrew:</p>

<ol>
<li>
<code>brew versions libmemcached</code>
</li>
<li>
Find and note the version number you want. In my case I wasn&#8217;t sure, so I just went with the second newest and that worked.
</li>
<li>
<code>brew switch libmemcached 1.0.4</code>
</li>
</ol>


<p>Change the version number and the formula above to whatever makes sense for what you are doing.</p>

<p>The example above is using a command that is an <a href="https://github.com/mxcl/homebrew/wiki/External-Commands">external command</a> for Homebrew. It works super fast and is easy to use.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/02/05/whats-with-the-weird-name/">What&#8217;s With the Weird Name?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-05T19:09:00+01:00" pubdate data-updated="true">Feb 5<span>th</span>, 2012</time>
        
         | <a href="/2012/02/05/whats-with-the-weird-name/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So, Camilla.. Why is your nick everywhere <em>naxoc</em>?.</p>

<p>Xoc means shark in Yucatec Maya. It might actually be <a href="" title="http://en.wikipedia.org/wiki/Yucatec_Maya_language#English_words_derived_from_Maya">one of the very few words that made it into English</a>. I used to study American Indian Language and Culture at the University of Copenhagen. Those were the days with much nerding over Mayan hieroglyphics. Maya hieroglyphic texts are often about how fantastic the rulers where and one of the more fantastic female rulers was called <a href="" title="http://en.wikipedia.org/wiki/Lady_Xoc">Lady Xoc</a>. I thought she was pretty cool, so I stole the name. The Na- prefix is simply a marker for female. So there is the story of my weird nick.</p>

<p>It is pronounced “nashoc”.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/09/14/navigating-with-krumo/">Navigating With Krumo</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-14T09:13:00+02:00" pubdate data-updated="true">Sep 14<span>th</span>, 2011</time>
        
         | <a href="/2011/09/14/navigating-with-krumo/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://drupal.org/project/devel" title="Devel | drupal.org">The Devel module</a> includes the super helpful <a href="http://krumo.sourceforge.net/">Krumo library</a>. I use <code>dsm()</code> and <code>krumo()</code> all the time. If you are not familiar with Devel, you should try it. Morten Wulff wrote a <a href="https://ratatosk.backpackit.com/pub/1836982-debugging-drupal">demo page for the module</a>.<br/>
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/krumo.png"><br/>
Today a client suggested that the Devel module Krumo could display the &ldquo;path&rdquo; to an item in an array by right clicking or otherwise interacting with the nested elements in the output from Krumo. I was really excited about that idea &ndash; I can&rsquo;t count the number of times I have tried and failed to target an item deep in a form array or an item in the node object simply because my human brain can&rsquo;t remember a structure like <code>$form['#node']-&gt;content['links']['comment']['#attributes']['class']</code> for more than 3 seconds.</p>

<p>Still very happy with this new idea I went straight home and started to hack away at the Krumo library to make it display the path to a desired item. After looking at the javascript for a while, and saying out loud that Javascript hates me, I realized that the killer feature I was trying to make already exists in Krumo! This is a well hidden gem that I haven&rsquo;t seen before today, so I thought I would share it:
If you double click an item in the Krumo output it prints the items array &ldquo;path&rdquo; so that you can copy paste it into your code and stop worrying about remembering long array structures.<br/>
<img class="center" src="https://dl.dropboxusercontent.com/u/157691/cdn/naxocnet/krumo_path.png" title="'krumo with array path'" >
Thanks to Niels Fanøe for the inspiration.</p>

<p>EDIT: I was using the dev D7 version, and the feature just went in this August. Thanks to Mark Theunissen for pointing that out. I also feel less stupid for not discovering the feature before now!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/05/11/moving-an-itunes-library/">Moving an iTunes Library</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-05-11T15:22:00+02:00" pubdate data-updated="true">May 11<span>th</span>, 2011</time>
        
         | <a href="/2011/05/11/moving-an-itunes-library/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you are moving an iTunes library to a new mac it will go smooth if the user login is the same. So if I move my iTunes library from an old machine where it was located in <code>/Users/ckj/iTunes</code> to a new machine where it is gonna go in <code>/Users/ckj/iTunes</code> &ndash; I have no problems. But if I changed to another username on the new machine &ndash; all the paths in the iTunes Library.xml file will not be correct anymore. I have moved libraries so many times now and I thought I would share a really quick way to fix the iTunes Library.xml file to reflect the correct user directory.</p>

<p>If you use the built-in command line tool called <a href="http://en.wikipedia.org/wiki/Sed">sed</a>, you can type one line in the terminal and be done. Let’s say I was moving from a mac with a user directory called &ldquo;ckj&rdquo; to another machine with a user directory called &ldquo;naxoc&rdquo;. All I would have to do in the terminal would be this:</p>

<ol>
<li>cd to the iTunes folder in the user directory you are moving to.</li>
<li>Enter this: <code>sed -i "" -e "s,Users/ckj,Users/naxoc,g" files iTunes\ Library.xml</code></li>
</ol>


<p>Note the funky syntax with the <code>-i ""</code> This is a mac quirck in sed. I found some info on it <a href="http://stackoverflow.com/questions/2320564/variations-of-sed-between-osx-and-gnu-linux">here</a>.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/11/22/format-json-output-from-curl-neatly/">Format json output from cUrl neatly</a>
      </li>
    
      <li class="post">
        <a href="/2013/11/10/color-schemes-and-productivity/">Color schemes and productivity</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/28/finding-unused-images-in-your-website-code/">Finding unused images in your website code</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/22/windows-in-virtualbox-on-the-mac/">Windows in VirtualBox on the Mac</a>
      </li>
    
      <li class="post">
        <a href="/2013/10/06/setting-up-a-file-watcher-for-compass-in-phpstorm/">Setting up a file watcher for Compass in PHPStorm</a>
      </li>
    
  </ul>
</section>
<section class="drupal-association">
<img src="http://drupal.org/files/images/DA-individual-80.png" />
</section><section>
  <h1>On Goodreads</h1>
  <div id="goodreads"></div>
      <style type="text/css" media="screen">
        .gr_grid_container {
          /* customize grid container div here. eg: width: 500px; */
        }

        .gr_grid_book_container {
          /* customize book cover container div here */
          float: left;
          width: 98px;
          height: 160px;
          padding: 0px 0px;
          overflow: hidden;
        }
      </style>
      <div id="gr_grid_widget_1375689543">
        <!-- Show static html as a placeholder in case js is not enabled - javascript include will override this if things work -->
          <div class="gr_grid_container">
          </div>
      </div>
      <script src="http://www.goodreads.com/review/grid_widget/1493819.Camilla's%20bookshelf:%20read?cover_size=medium&hide_link=true&hide_title=true&num_books=20&order=d&shelf=read&sort=date_read&widget_id=1375689543" type="text/javascript" charset="utf-8"></script>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Camilla Krag Jensen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'naxocnet';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
